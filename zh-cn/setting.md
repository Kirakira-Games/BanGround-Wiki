# 游戏基础设定

## 评级

### 单个Note准确率

击打Note会获得不同的评价，不同的评价累积的准确率不同。

| 击打评价 | 准确率 |
| -------- | ------ |
| Perfect  | 100%   |
| Great    | 80%    |
| Good     | 50%    |
| Bad      | 20%    |
| Miss     | 0%     |

### 评级计算

设*n*为已击打的Note总数，$ a_i $为第i个Note的击打准确率，则累积准确率$ acc $为：

$$
acc=\frac{\sum_{i=1}^n a_i}{n}
$$

### 评价等级

结算时，按照演出的累积准确率进行评级，评级依据如下：

|评价|准确率|
|----|----|
|SSS |99.8%|
|SS|99%|
|S|97%|
|A|94%|
|B|90%|
|C|85%|
|D|60%|
|Failed|60%以下|

## 血量

玩家在游戏过程中有“血量”机制，初始有**1000**点，最小为**0**点。

不同的判定对于血量的影响不同。

单键、滑键、滑条起始键、滑条终止键的影响如下表：

| 判定    | 影响 |
| ------- | ---- |
| Perfect | +4   |
| Great   | +1   |
| Good    | 0    |
| Bad     | -50  |
| Miss    | -100 |

滑条节点的影响如下表：

| 判定    | 影响 |
| ------- | ---- |
| Perfect | +1   |
| Miss    | -20  |

血量会影响得分，具体的系数如下：

| 血量    | 得分系数 |
| ------- | -------- |
| 1000    | 1        |
| 900~999 | 0.9      |
| 800~899 | 0.8      |
| 600~799 | 0.7      |
| 300~599 | 0.6      |
| 0~299   | 0.5      |

## 得分

### 计算方法

**得分**是**音符击打得分之和转换为百万分制的整数**。

音符击打得分分为两部分：

* 判定得分
  即Note的准确率，设为$ a_i $。
* 血量得分
  即当前Note判定后，血量对应的得分系数，设为$ h_i $。

设每个Note的得分为$ x_i $，则： $$ x_i=a_i*h_i $$

计算分为两部分：

* 实际总分（f）：假定所有的Note判定均为Perfect时，累加的结果。

* 实际得分（s）：玩家游玩时Note得分累加的结果。

则得分为：

$$ \frac{s}{f}*1000000 $$

## 判定

按键的判定范围为Note所在轨道的左、右各0.75个轨道之间（共计2.5个轨道的宽度）。
下表为各种按键的判定范围（单位：毫秒）以及Miss判定的情况：

| Note种类                  | Perfect | Great      | Good        | Bad         | Miss                                 |
| ------------------------- | ------- | --------- | ------------ | ------------ | ------------------------------------ |
| 单键                      | -40 ~ +40 | -90 ~ +90 | -111 ~ +111 | -133 ~ +133 | 无输入 |
| 滑键                      | -40 ~ +40 | -90 ~ +90 | -111 ~ +111 | -133 ~ +133 | 无输入或按下未滑动 |
| 直长条头                  | -40 ~ +40 | -90 ~ +90 | -111 ~ +111 | -133 ~ +133 | 无输入或滑动 |
| 直长条尾                  | -40 ~ +40 | -90 ~ +90 | -111 ~ +111 | -133 ~ +133 | 无输入或滑动 |
| 直长条尾滑键              | -57 ~ +57 | -107 ~ +107 | -128 ~ +128 | -150 ~ +150 | 无输入或在击打长条时直接松开滑条 |
| 斜长条头                  | -57 ~ +57 | -107 ~ +107 | -128 ~ +128 | -150 ~ +150 | 无输入或滑动 |
| 斜长条尾                  | -34 ~ +200 | -84 ~ -50 | -100 ~ -84 | -117 ~ -100 | 无输入或滑动 |
| 斜长条尾滑键              | 0 ~ +100  | 无      | 无      | 无      | 无输入或在击打长条时直接松开滑条 |
| 滑条节点                  | 0 ~ +200 | 无      | 无      | 无      | 无输入 |

另外，值得注意的判定机制有：

> * 当一次输入处于多个Note的判定范围内时，**最早出现的Note将优先判定**。
> * 滑条击打中断时，只要在下一个节点的判定范围内有输入，即可成功判定。

## Mod

Mod是一种影响游戏表现的程序。它会改变同一张谱面在游戏内的表现，或是改变玩家的体验。
下表为当前游戏内已实装的Mod列表：

| Mod名称      | 得分倍率      | 作用                                               |
| ------------ | ------------ | ------------------------------------------------- |
| Double Time  | 1.1x         | 使音乐播放和按键出现速度变为原先的1.5倍，保持音调不变 |
| Nightcore    | 1.1x         | 使音乐播放和按键出现速度变为原先的1.5倍              |
| Half Time    | 0.75x        | 使音乐播放和按键出现速度变为原先的0.75倍，保持音调不变 |
| Daycore      | 0.75x        | 使音乐播放和按键出现速度变为原先的0.75倍              |
| Mirror | 1.0x | 使谱面变为镜像 |
| Autoplay     | 1.0x         | 由程序自动游玩谱面（不保存纪录和计入排行）            |
| Sudden Death | 1.0x         | 连击中断自动重新开始                                |
| Perfect      | 1.0x         | 取得Perfect以下的判定时自动重新开始                  |

*得分倍率的影响：使得实际得分为原得分与所有得分倍率的积。*